var pe=Object.defineProperty,ve=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var K=(e,t,n)=>t in e?pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))me.call(t,n)&&K(e,n,t[n]);if(Q)for(var n of Q(t))ye.call(t,n)&&K(e,n,t[n]);return e},k=(e,t)=>ve(e,fe(t));import{d as U,u as _e,r as x,c as A,o as v,a as m,b as l,t as T,n as O,e as ne,w as Y,f,F as L,g as P,h as E,i as G,j as q,k as H,l as se,v as ge,m as oe,p as he,q as W,s as we,x as be,P as X,y as xe,z as ae,A as F,T as ie,B as Ce,C as Ie,D as V,E as Se,G as ke,H as Te,I as Ee,J as $e}from"./vendor.6cb6941b.js";const Le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};Le();function J(){return["A","B","C","D"][Math.round(Math.random()*3)]}const z=()=>["aqua","green","gray","royalblue"][Math.round(Math.random()*3)];var R=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n};const Me={key:0,class:"name"},Be=["value"],qe=U({props:{name:String,editable:{type:Boolean,default:!1},bgColor:{type:String,default:z()}},emits:["change"],setup(e,{emit:t}){const n=e;_e(i=>({"4812e114":e.bgColor}));const o=x(),s=x(!1),a=A({get:()=>n.editable?s.value:!1,set:i=>{s.value=i}}),r=()=>{!n.editable||(a.value=!0,ne(()=>{var i;(i=o.value)==null||i.focus()}))},p=()=>{var u;a.value=!1;const i=(u=o.value)==null?void 0:u.value;i!==name&&t("change",i)};return(i,u)=>(v(),m("div",{class:O({avatar:!0,editable:e.editable}),onClick:u[1]||(u[1]=c=>r())},[l(a)?(v(),m("input",{key:1,class:"editor",ref_key:"input",ref:o,type:"text",value:e.name,onBlur:u[0]||(u[0]=c=>p())},null,40,Be)):(v(),m("span",Me,T(e.name),1))],2))}});var N=R(qe,[["__scopeId","data-v-6d8f6073"]]);const j={};function $(e,t){const n=localStorage.getItem(e);if(n===null){if(t===void 0)throw new Error(`key ${e} has not be initialed`);return localStorage.setItem(e,JSON.stringify(t)),$(e)}const o=JSON.parse(n);if(!j[e]){const s=x(o);j[e]=s,Y(s,a=>{localStorage.setItem(e,JSON.stringify(a))})}return j[e]}const Ue=async(e={type:"file",multiple:!1})=>{const t=document.createElement("input");t.type=e.type,t.accept="*",t.style.position="absolute",t.style.left="-1000px",t.style.top="-1000px",t.style.opacity="0",document.body.append(t),t.focus(),t.click();const n=()=>{t.parentNode===document.body&&document.body.removeChild(t)};return await new Promise((s,a)=>{t.addEventListener("change",r=>{s(t.files),n()}),t.addEventListener("error",a),t.addEventListener("blur",()=>{n()})})};var w=(e=>(e.initial="Checking",e.spare="Connect",e.connected="Connected",e.connecting="Connecting",e.stoping="Stoping",e))(w||{}),I=(e=>(e[e.waiting=0]="waiting",e[e.holding=1]="holding",e[e.connecting=2]="connecting",e))(I||{});const Re=e=>e,Ve={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},De=f("path",{d:"m0 0 1024 512L0 1024V0zm0 409.6v204.8L512 512 0 409.6z"},null,-1),Pe=[De];function Ne(e,t){return v(),m("svg",Ve,Pe)}var He={render:Ne};const Oe={class:"list"},Ae={class:"avatar"},Fe={class:"bubble allow-select"},ze=["src"],je=["href","download"],Ye={class:"tag"},Ge={class:"pannel"},Je=U({props:{messageList:null},emits:["send"],setup(e,{emit:t}){const n=e,o=$("peerInfo"),s=x(""),a=()=>{s.value!==""&&(t("send",{type:"text",content:s.value}),s.value="")},r=x(),p=()=>{ne(()=>{var i,u,c,d;(d=(i=r.value)==null?void 0:i.parentElement)==null||d.scrollTo({behavior:"smooth",top:(c=(u=r.value)==null?void 0:u.scrollHeight)!=null?c:0+300})})};return Y(()=>n.messageList.length,()=>{p()}),(i,u)=>(v(),m("div",{class:"chat",ref_key:"chatRef",ref:r},[f("div",Oe,[(v(!0),m(L,null,P(e.messageList,(c,d)=>(v(),m("div",{key:d,class:O(["message",{self:c.user.id===l(o).id}])},[f("div",Ae,[E(N,{name:c.user.name,"bg-color":c.user.bgColor},null,8,["name","bg-color"])]),f("div",Fe,[c.dataType==="text"?(v(),m(L,{key:0},[G(T(c.content),1)],64)):c.dataType==="image"?(v(),m("img",{key:1,src:c.dataUrl},null,8,ze)):c.dataType==="file"?(v(),m("a",{key:2,href:c.dataUrl,download:c.fileName},T(c.fileName),9,je)):q("",!0)]),f("div",Ye,T(l(H).unix(c.sendTime).format("YYYY-MM-DD HH:MM:ss")),1)],2))),128))]),f("div",Ge,[se(f("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>s.value=c),type:"text",onChange:u[1]||(u[1]=c=>a())},null,544),[[ge,s.value]]),f("button",{onClick:u[2]||(u[2]=c=>a())},[E(l(He))])])],512))}});var Qe=R(Je,[["__scopeId","data-v-01cca4c0"]]);const Ke=()=>{confirm("This will clear all user infomation, Are your sure ?")&&(localStorage.clear(),location.reload())},We={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Xe=f("path",{d:"M191.015 710.892V222.523c-51.2 0-92.553 41.354-92.553 90.585v578.954c0 51.2 41.353 92.553 92.553 92.553h458.831c51.2 0 92.554-41.353 92.554-90.584H374.154c-100.43 0-183.139 0-183.139-183.139zm703.016-397.784h-153.6c-51.2 0-92.554-41.354-92.554-90.585v-153.6c1.97-15.754-11.815-29.538-29.539-29.538H374.154c-51.2 0-92.554 41.353-92.554 90.584v578.954c0 51.2 41.354 90.585 92.554 90.585h458.83c51.2 0 92.554-41.354 92.554-90.585V344.615c0-17.723-13.784-31.507-31.507-31.507zm25.6-128L777.846 45.292c-3.938-3.938-7.877-5.907-13.784-5.907-11.816 0-21.662 9.846-21.662 21.661v100.43c0 33.478 27.57 61.047 61.046 61.047h100.43c11.816 0 21.662-9.846 21.662-21.661 0-5.908-1.969-9.847-5.907-15.754z"},null,-1),Ze=[Xe];function et(e,t){return v(),m("svg",We,Ze)}var tt={render:et};const nt={class:"message-text"},st=U({props:{text:{type:String,default:""},visible:{type:Boolean,default:!1},delay:{type:Number,default:2e3},type:{type:String,default:"success"},onFullDestroyed:{type:Function,default:()=>({})}},emits:["fullDestroyed"],setup(e,{emit:t}){const n=e,o=x(n.visible);oe(()=>{o.value=n.visible});const s=()=>{o.value=!0,setTimeout(()=>{o.value=!1,setTimeout(()=>{t("fullDestroyed")},200)},n.delay)};return he(()=>{setTimeout(()=>{s()},1)}),(a,r)=>(v(),m("div",{class:O(["message",`${o.value?"showed":""} ${e.type}`])},[f("div",nt,T(e.text),1)],2))}});var ot=R(st,[["__scopeId","data-v-75766499"]]);function at(e,t){const o=E(ot,C({visible:!1,text:e,onFullDestroyed:()=>{W(null,s),s.parentNode===document.body&&document.body.removeChild(s)}},t)),s=document.createElement("div");o.props&&(o.props.onVnodeUnmounted=()=>{document.body.removeChild(s)}),W(o,s),document.body.appendChild(s)}var ce=(e=>(e.request="Srequest",e.accept="Saccept",e.decline="Sdecline",e.stop="Sstop",e))(ce||{});function it(){let e;const t=d=>{e=d,r()};let n=!1;const o=new EventTarget;let s=()=>Promise.reject(),a;const r=()=>{e.on("data",d=>{if(!!Object.values(ce).includes(d.type))switch(d.type){case"Saccept":o.dispatchEvent(new CustomEvent("accept"));break;case"Srequest":{s(d.content).then(()=>{e.send({type:"Saccept"})}).catch(()=>{e.send({type:"Sdecline"})});break}case"Sdecline":o.dispatchEvent(new CustomEvent("decline"));break;case"Sstop":a(),o.dispatchEvent(new CustomEvent("decline"));break}})};return{use:t,requestAccept:async d=>await new Promise((S,_)=>{e.send({type:"Srequest",content:d}),n=!1,o.addEventListener("accept",()=>{n&&_(),S(!0)}),o.addEventListener("decline",()=>{_()})}),onBeRequested:d=>{s=d},onBeStopped:d=>{a=d},stop:()=>{o.dispatchEvent(new CustomEvent("stop")),e.send({type:"Sstop"})}}}var re=(e=>(e.hand="handflag",e))(re||{});function ct(){const e=$("userInfo",{name:J(),bgColor:z()}),t=Boolean(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia),n=$("peerInfo",{id:"",createTime:-1}),o=we({participants:[k(C({},e.value),{id:n.value.id,userMedia:t})],type:"",status:w.initial,userMedia:t});let s;const a=p=>{s=p,r(),o.participants[0].id=n.value.id},r=()=>{o.status=w.connected,s.on("data",p=>{!Object.values(re).includes(p.type)||(o.status=w.connected,o.participants.every(i=>i.id!==p.user.id)&&(o.participants.push(p.user),s.send({type:"handflag",user:k(C({},e.value),{id:n.value.id,useMedia:t})})))}),s.send({type:"handflag",user:k(C({},e.value),{id:n.value.id,userMedia:t})})};return{use:a,connectionInfo:o}}var le=(e=>(e.start="Mstart",e.content="MContent",e.end="Mend",e))(le||{});function rt(){const e=$("userInfo",{name:J(),bgColor:z()}),t=$("peerInfo",{id:"",createTime:-1});let n;const o=i=>{n=i,r()},s=new Map,a=x([]),r=()=>{n.on("data",i=>{var u;if(!!Object.values(le).includes(i.type))switch(i.type){case"Mstart":s.set(i.id,i),a.value.push(i);break;case"MContent":const c=k(C(C({},s.get(i.id)),i),{type:"Mend",recieveTime:H().unix(),dataUrl:i.dataType!=="text"?URL.createObjectURL(new Blob([i.content],{type:i.fileType})):void 0});s.set(i.id,c);const d=a.value.findIndex(S=>S.id===i.id);a.value[d]=c,n.send({id:i.id,type:"Mend",reciveTime:(u=s.get(i.id))==null?void 0:u.recieveTime});break;case"Mend":s.set(i.id,k(C({},s.get(i.id)),{recieveTime:i.recieveTime}));const b=a.value.findIndex(S=>S.id===i.id);a.value[b].recieveTime=i.recieveTime;break}})};return{use:o,messageList:a,sendData:i=>{const u=be(),c={user:{name:e.value.name,id:t.value.id,bgColor:e.value.bgColor},sendTime:H().unix(),dataType:i.dataType,type:"Mstart",id:u,fileType:i.fileType,fileName:i.fileName},d={content:i.content,id:u,type:"MContent",fileType:i.fileType,fileName:i.fileName};n.send(c),n.send(d);const b=k(C(C({},c),d),{recieveTime:-1,dataUrl:i.dataType!=="text"?URL.createObjectURL(new Blob([i.content],{type:i.fileType})):void 0});s.set(u,b),a.value.push(b)}}}function lt(e){const t=$("peerInfo",{id:"",createTime:-1}),n=$("connectStatus",w.initial),o=1/0;if(t.value.id===""||H().unix()-t.value.createTime>o&&n.value===w.spare){t.value={id:"",createTime:-1};const a=new X;a.on("open",()=>{t.value={id:a.id,createTime:H().unix()},e(a)})}const s=new X(t.value.id);s.on("open",()=>{e(s)})}function dt(){let e,t,n;const o=c=>{e=c,r()};let s=c=>{},a=new EventTarget;const r=()=>{e.on("call",c=>{c.answer(),c.on("stream",d=>{s(d),a.addEventListener("close",()=>{var b;(b=d==null?void 0:d.stop)==null||b.call(d)})}),c.on("close",function(){})})},p=(c,d)=>new Promise((b,S)=>{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({audio:!0,video:c==="video"},_=>{n=_,b(_),t=e.call(d,_,{metadata:{type:c,selfId:e.id}})},S)});return a.addEventListener("close",()=>{var c;!n||((c=n.stop)==null||c.call(n),n.getTracks().forEach(d=>{d.readyState==="live"&&d.stop()}))}),{use:o,call:p,close:()=>{t==null||t.close(),a.dispatchEvent(new CustomEvent("close"))},onStream:c=>{s=c}}}function ut(){let e;const t=()=>lt(c=>{e=c,r.connectionInfo.status=w.spare,c.on("connection",d=>{s(d)}),c.on("error",u)});t();let n;const o=c=>{if(!e||!c)return;if(r.connectionInfo.status===w.connecting){r.connectionInfo.status=w.stoping,e.on("disconnected",()=>{t(),r.connectionInfo.status=w.spare}),e.disconnect();return}r.connectionInfo.status=w.connecting,e.on("error",u);const d=e.connect(c);s(d)},s=c=>{n=c,i.use(e),n.on("open",()=>{r.use(n),a.use(n),p.use(n)}),n.on("error",u)},a=rt(),r=ct(),p=it(),i=dt(),u=c=>{r.connectionInfo.status=w.spare,at(c,{type:"error"})};return{toConnect:o,messageSystem:a,connectInfoSystem:r,acceptSystem:p,streamSystem:i}}const pt={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},vt=f("path",{d:"M1024 201.143v621.714q0 24-22.286 33.714-7.428 2.858-14.285 2.858-15.429 0-25.715-10.858L731.43 618.286v94.857q0 68-48.286 116.286t-116.286 48.285H164.571q-68 0-116.285-48.285T0 713.143V310.857q0-68 48.286-116.286t116.285-48.285h402.286q68 0 116.286 48.285t48.286 116.286v94.286l230.285-229.714Q972 164.57 987.43 164.57q6.857 0 14.285 2.858Q1024 177.143 1024 201.143z"},null,-1),ft=[vt];function mt(e,t){return v(),m("svg",pt,ft)}var yt={render:mt};const _t={class:"picker"},gt={key:0,class:"popup"},ht=["onClick"],wt=U({props:{list:null},emits:["choose"],setup(e,{emit:t}){const n=x(!1);return(o,s)=>{const a=xe("click-outside");return v(),m("div",_t,[f("div",{class:"content",onClick:s[0]||(s[0]=()=>n.value=!n.value)},[ae(o.$slots,"default",{},void 0,!0)]),E(ie,{name:"slide-fade"},{default:F(()=>[n.value?se((v(),m("div",gt,[(v(!0),m(L,null,P(e.list,(r,p)=>(v(),m("div",{class:"item",key:p,onClick:()=>{t("choose",r,p),n.value=!1}},T(r),9,ht))),128))])),[[a,()=>n.value=!1]]):q("",!0)]),_:1})])}}});var bt=R(wt,[["__scopeId","data-v-71516db5"]]);const xt={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Ct=f("path",{d:"M914.286 708.571q0 15.429-5.715 40.286t-12 39.143q-12 28.571-69.714 60.571-53.714 29.143-106.286 29.143-15.428 0-30-2t-32.857-7.143-27.143-8.285-31.714-11.715-28-10.285q-56-20-100-47.429-73.143-45.143-151.143-123.143T196.571 516.571q-27.428-44-47.428-100-1.714-5.142-10.286-28t-11.714-31.714-8.286-27.143-7.143-32.857-2-30q0-52.571 29.143-106.286 32-57.714 60.572-69.714 14.285-6.286 39.142-12t40.286-5.714q8 0 12 1.714 10.286 3.429 30.286 43.429 6.286 10.857 17.143 30.857t20 36.286T376 216q1.714 2.286 10 14.286t12.286 20.285 4 16.286q0 11.429-16.286 28.572t-35.429 31.428-35.428 30.286-16.286 26.286q0 5.142 2.857 12.857T306.571 408t8 13.714 6.572 10.857q43.428 78.286 99.428 134.286t134.286 99.429q1.143.571 10.857 6.571t13.715 8 11.714 4.857T604 688.571q10.286 0 26.286-16.285t30.285-35.429T692 601.43t28.571-16.286q8 0 16.286 4t20.286 12.286 14.286 10Q785.714 620 802 629.143t36.286 20 30.857 17.143q40 20 43.428 30.285 1.715 4 1.715 12z"},null,-1),It=[Ct];function St(e,t){return v(),m("svg",xt,It)}var Z={render:St};function kt(){const e=["touchstart","scroll"],t=o=>{document.body.style.position="fixed",o.preventDefault(),o.stopPropagation()};e.forEach(o=>{document.body.addEventListener(o,s=>{document.body.style.position="fixed",s.preventDefault(),s.stopPropagation()})});const n=()=>e.forEach(o=>{document.body.removeEventListener(o,t)});return Ce(()=>{n()}),n}function Tt(){const e=x([]),t=n=>{e.value.push(n)};return Ie(()=>{e.value=[]}),{setRefs:t,refs:e}}const Et={class:"video-chat"},$t={class:"videos"},Lt={key:0,class:"avatars"},Mt={key:1,class:"info"},Bt={class:"buttons"},qt=U({props:{status:null,users:null,type:null},emits:["decline","accept","stop"],setup(e,{expose:t,emit:n}){const o=e,{refs:s,setRefs:a}=Tt();return oe(()=>{o.users.forEach((r,p)=>{var i;r.stream&&((i=s.value)==null?void 0:i[p])&&(s.value[p].srcObject=r.stream,s.value[p].play())})}),kt(),t({videoRefs:s}),(r,p)=>(v(),m("div",Et,[f("div",{class:O(["frame",{waiting:o.status===l(I).waiting,connecting:o.status===l(I).connecting,holding:o.status===l(I).holding}])},[f("div",$t,[(v(!0),m(L,null,P(e.users,(i,u)=>(v(),m("video",{key:u,ref_for:!0,ref:l(a),playsinline:""}))),128))]),o.status!==l(I).connecting?(v(),m("div",Lt,[(v(!0),m(L,null,P(o.users,(i,u)=>(v(),V(N,{name:i.name,"bg-color":i.bgColor,editable:!1,key:u},null,8,["name","bg-color"]))),128))])):q("",!0),o.status!==l(I).connecting?(v(),m("div",Mt,T(o.status===l(I).waiting?"Waiting for accept...":"You get a VideoCall Invitation"),1)):q("",!0),f("div",Bt,[o.status===l(I).holding?(v(),m("button",{key:0,class:"accept",onClick:p[0]||(p[0]=i=>n("accept"))},[E(l(Z))])):q("",!0),f("button",{class:"decline",onClick:p[1]||(p[1]=i=>n(o.status===l(I).holding?"decline":"stop"))},[E(l(Z))])])],2)]))}});var Ut=R(qt,[["__scopeId","data-v-92af8a1c"]]);const Rt={class:"video tool-button"},Vt=U({props:{acceptSystem:null,users:null,streamSystem:null},setup(e){const t=e,n=x(t.users),o=$("peerInfo",{id:"",createTime:-1}),s=x(!1),a=x(I.waiting),r=x("video"),p=()=>{n.value.forEach(_=>{_.stream=void 0})},i=new EventTarget,u=async _=>{const M=n.value.findIndex(y=>y.id!==o.value.id),g=await t.streamSystem.call(_,n.value[M].id);n.value[0].stream=g},c=()=>{i.dispatchEvent(new CustomEvent("accept")),a.value=I.connecting,u(r.value)},d=()=>{i.dispatchEvent(new CustomEvent("decline")),s.value=!1,t.streamSystem.close(),p()},b=()=>{i.dispatchEvent(new CustomEvent("stop")),s.value=!1,t.acceptSystem.stop(),t.streamSystem.close(),p()},S=async _=>{r.value=_,s.value=!0,a.value=I.waiting;try{await t.acceptSystem.requestAccept(_),a.value=I.connecting,await u(_)}catch{s.value=!1}};return t.acceptSystem.onBeStopped(()=>{s.value=!1,i.dispatchEvent(new CustomEvent("stop")),t.streamSystem.close(),p()}),t.acceptSystem.onBeRequested(_=>new Promise((M,g)=>{r.value=_,s.value=!0,a.value=I.holding;const y=()=>{a.value=I.connecting,M(!0)},h=()=>{s.value=!1,g()},D=()=>{s.value=!1,g(),i.removeEventListener("accept",y),i.removeEventListener("decline",h),i.removeEventListener("stop",D)};i.addEventListener("accept",y),i.addEventListener("decline",h),i.addEventListener("stop",D)})),t.streamSystem.onStream(_=>{const M=n.value.findIndex(g=>g.id!==o.value.id);M!==-1&&(n.value[M].stream=_)}),(_,M)=>(v(),m(L,null,[E(bt,{list:["video","voice"],onChoose:S},{default:F(()=>[f("button",Rt,[E(l(yt))])]),_:1}),(v(),V(Se,{to:"body"},[E(ie,null,{default:F(()=>[s.value?(v(),V(Ut,{key:0,type:r.value,status:a.value,users:n.value,onAccept:c,onDecline:d,onStop:b},null,8,["type","status","users"])):q("",!0)]),_:1})]))],64))}});var Dt=R(Vt,[["__scopeId","data-v-ca364aa0"]]);const Pt={tabindex:"1",class:"input-field"},Nt=["value"],Ht=U({props:{modelValue:null,showFilterList:{type:Boolean},filterList:null},emits:["update:modelValue"],setup(e){const t=x(),n=x();return(o,s)=>(v(),m("div",{tabindex:"0",class:"custom-input",ref_key:"wrapRef",ref:n},[f("div",Pt,[f("input",ke({ref_key:"inputRef",ref:t,value:e.modelValue,onInput:s[0]||(s[0]=a=>{var r;return o.$emit("update:modelValue",(r=a==null?void 0:a.target)==null?void 0:r.value)})},o.$attrs),null,16,Nt),f("button",{class:"clear",onTouchstart:s[1]||(s[1]=()=>{}),onClick:s[2]||(s[2]=()=>{var a;o.$emit("update:modelValue",""),(a=t.value)==null||a.focus()})},null,32)]),e.showFilterList?(v(),m("div",{key:0,class:"filter-list",onClick:s[4]||(s[4]=()=>{var a;(a=n.value)==null||a.blur()})},[(v(!0),m(L,null,P(e.filterList,(a,r)=>(v(),m("div",{key:r,class:"list-item",onClick:s[3]||(s[3]=()=>{})},[ae(o.$slots,"default",Te(Ee(a)),()=>[G(T(a),1)],!0)]))),128))])):q("",!0)],512))}});var Ot=R(Ht,[["__scopeId","data-v-093840cf"]]);function At(e=15){const t=$("history",{users:[]}),n=t.value.users;return{users:n,addUser:a=>{const r=n.findIndex(p=>p.id===a.id);if(r===-1){if(n.length===e)return;console.log("pushed",a),n.unshift(a),t.value=k(C({},t.value),{users:n})}else n[r]=a,t.value=k(C({},t.value),{users:n})},deleteUser:a=>{const r=n.findIndex(p=>p.id===a);n.splice(r,1),t.value=k(C({},t.value),{users:n})}}}const Ft={class:"header"},zt={class:"avatars"},jt={class:"tools"},Yt={class:"content"},Gt={key:1,class:"home"},Jt={class:"welcome"},Qt={class:"id-field"},Kt=G(" Your ID is "),Wt={class:"id-text allow-select"},Xt={class:"id-editor"},Zt=["onClick"],en={class:"right"},tn={class:"full-name"},nn=["onClick"],sn=["disabled"],on=U({setup(e){const t=$("peerInfo",{id:"",createTime:-1}),n=ut(),o=A(()=>n.connectInfoSystem.connectionInfo.status),s=g=>{n.toConnect(g)},a=n.messageSystem.messageList,r=g=>{n.messageSystem.sendData(k(C({},g),{dataType:"text"}))},p=async()=>{const g=await Ue(),y=g.item(0),h=(y==null?void 0:y.type.includes("image"))?"image":"file";n.messageSystem.sendData({dataType:h,content:new Blob(g,{type:y==null?void 0:y.type}),fileType:y.type,fileName:y.name})},i=$("userInfo",{name:J(),bgColor:z()}),u=n.connectInfoSystem.connectionInfo,c=A(()=>n.connectInfoSystem.connectionInfo.participants.every(g=>g.userMedia)),d=x(""),{users:b,deleteUser:S,addUser:_}=At(),M=A(()=>b.length>0);return Y(u.participants,()=>{u.participants.forEach(g=>{g.id!==t.value.id&&_(g)})}),(g,y)=>(v(),m(L,null,[f("div",Ft,[f("div",zt,[l(o)!==l(w).connected?(v(),V(N,{key:0,name:l(i).name,"bg-color":l(i).bgColor,editable:!0,onChange:y[0]||(y[0]=h=>{i.value=k(C({},l(i)),{name:h})})},null,8,["name","bg-color"])):(v(!0),m(L,{key:1},P(l(u).participants,(h,D)=>(v(),V(N,{name:h.name,"bg-color":h.bgColor,editable:!1,key:D},null,8,["name","bg-color"]))),128))]),f("div",jt,[l(o)!==l(w).connected?(v(),m("button",{key:0,class:"reset",onClick:y[1]||(y[1]=h=>l(Ke)())}," reset ")):(v(),m(L,{key:1},[f("button",{class:"file tool-button",onClick:y[2]||(y[2]=()=>p())},[E(l(tt))]),l(c)?(v(),V(Dt,{key:0,"accept-system":l(n).acceptSystem,users:l(u).participants,"stream-system":l(n).streamSystem},null,8,["accept-system","users","stream-system"])):q("",!0)],64))])]),f("div",Yt,[l(o)===l(w).connected?(v(),V(Qe,{key:0,"message-list":l(a),onSend:r},null,8,["message-list"])):(v(),m("div",Gt,[f("div",Jt,"Hello,"+T(l(i).name),1),f("div",Qt,[Kt,f("span",Wt,T(l(t).id),1)]),f("div",Xt,[E(Ot,{modelValue:d.value,"onUpdate:modelValue":y[3]||(y[3]=h=>d.value=h),placeholder:"input id here",type:"text",class:"id-input","show-filter-list":l(M),"filter-list":l(b)},{default:F(h=>[f("div",{class:"history-user",onClick:()=>{d.value=h.id}},[f("div",en,[E(N,{name:h.name,"bg-color":h.bgColor},null,8,["name","bg-color"]),f("div",tn,T(h.name),1)]),f("button",{class:"remove-user",onClick:D=>{l(S)(h.id),D.stopPropagation()}},null,8,nn)],8,Zt)]),_:1},8,["modelValue","show-filter-list","filter-list"])]),f("button",{class:O(["connect-button",{loading:l(o)===l(w).connecting}]),disabled:l(t).id===null||l(o)===l(w).stoping||l(o)===l(w).initial,onClick:y[4]||(y[4]=h=>s(l(Re)(d.value))),onTouchstart:y[5]||(y[5]=()=>{})},T(l(o)),43,sn)]))])],64))}});var an=R(on,[["__scopeId","data-v-7ee967c6"]]);const cn=e=>e instanceof Element,B=new Map;let ee;document.addEventListener("mousedown",e=>ee=e),document.addEventListener("mouseup",e=>{for(const t of B.values())for(const{documentHandler:n}of t)n(e,ee)});function te(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:cn(t.arg)&&n.push(t.arg),function(o,s){const a=t.instance.popperRef,r=o.target,p=s==null?void 0:s.target,i=!t||!t.instance,u=!r||!p,c=e.contains(r)||e.contains(p),d=e===r,b=n.length&&n.some(_=>_==null?void 0:_.contains(r))||n.length&&n.includes(p),S=a&&(a.contains(r)||a.contains(p));i||u||c||d||b||S||t.value(o,s)}}const rn={beforeMount(e,t){B.has(e)||B.set(e,[]),B.get(e).push({documentHandler:te(e,t),bindingFn:t.value})},updated(e,t){B.has(e)||B.set(e,[]);const n=B.get(e),o=n.findIndex(a=>a.bindingFn===t.oldValue),s={documentHandler:te(e,t),bindingFn:t.value};o>=0?n.splice(o,1,s):n.push(s)},unmounted(e){B.delete(e)}},de=()=>{document.body.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",de);window.addEventListener("DOMContentLoaded",de);const ue=$e(an);ue.directive("clickOutside",rn);ue.mount("#app");
