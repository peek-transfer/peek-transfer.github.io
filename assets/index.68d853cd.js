var ue=Object.defineProperty,pe=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Q=(e,t,n)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))fe.call(t,n)&&Q(e,n,t[n]);if(J)for(var n of J(t))me.call(t,n)&&Q(e,n,t[n]);return e},k=(e,t)=>pe(e,ve(t));import{d as U,u as ye,r as I,c as A,o as d,a as f,b as l,t as T,n as O,e as _e,w as te,f as v,F as M,g as R,h as E,i as Y,j as q,k as H,l as ne,v as ge,m as se,p as he,q as K,s as be,x as we,P as W,y as xe,z as oe,A as F,T as ae,B as Ce,C as Ie,D,E as Se,G as ke,H as Te,I as Ee,J as $e}from"./vendor.6cb6941b.js";const Me=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};Me();function G(){return["A","B","C","D"][Math.round(Math.random()*3)]}const z=()=>["aqua","green","gray","royalblue"][Math.round(Math.random()*3)];var V=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n};const Le={key:0,class:"name"},Be=["value"],qe=U({props:{name:String,editable:{type:Boolean,default:!1},bgColor:{type:String,default:z()}},emits:["change"],setup(e,{emit:t}){const n=e;ye(i=>({"4812e114":e.bgColor}));const o=I(),s=I(!1),a=A({get:()=>n.editable?s.value:!1,set:i=>{s.value=i}}),c=()=>{!n.editable||(a.value=!0,_e(()=>{var i;(i=o.value)==null||i.focus()}))},r=()=>{var m;a.value=!1;const i=(m=o.value)==null?void 0:m.value;i!==name&&t("change",i)};return(i,m)=>(d(),f("div",{class:O({avatar:!0,editable:e.editable}),onClick:m[1]||(m[1]=p=>c())},[l(a)?(d(),f("input",{key:1,class:"editor",ref_key:"input",ref:o,type:"text",value:e.name,onBlur:m[0]||(m[0]=p=>r())},null,40,Be)):(d(),f("span",Le,T(e.name),1))],2))}});var N=V(qe,[["__scopeId","data-v-6d8f6073"]]);const j={};function $(e,t){const n=localStorage.getItem(e);if(n===null){if(t===void 0)throw new Error(`key ${e} has not be initialed`);return localStorage.setItem(e,JSON.stringify(t)),$(e)}const o=JSON.parse(n);if(!j[e]){const s=I(o);j[e]=s,te(s,a=>{localStorage.setItem(e,JSON.stringify(a))})}return j[e]}const Ue=async(e={type:"file",multiple:!1})=>{const t=document.createElement("input");return t.type=e.type,t.accept="*",t.style.position="absolute",t.style.left="-1000px",t.style.top="-1000px",t.style.opacity="0",document.body.append(t),t.focus(),t.click(),await new Promise((o,s)=>{t.addEventListener("change",a=>{o(t.files),document.body.removeChild(t)}),t.addEventListener("error",s),t.addEventListener("blur",()=>{document.body.removeChild(t)})})};var b=(e=>(e.initial="Checking",e.spare="Connect",e.connected="Connected",e.connecting="Connecting",e.stoping="Stoping",e))(b||{}),C=(e=>(e[e.waiting=0]="waiting",e[e.holding=1]="holding",e[e.connecting=2]="connecting",e))(C||{});const Ve=e=>e,De={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Pe=v("path",{d:"m0 0 1024 512L0 1024V0zm0 409.6v204.8L512 512 0 409.6z"},null,-1),Re=[Pe];function Ne(e,t){return d(),f("svg",De,Re)}var He={render:Ne};const Oe={class:"chat"},Ae={class:"list"},Fe={class:"avatar"},ze={class:"bubble"},je=["src"],Ye=["href","download"],Ge={class:"tag"},Je={class:"pannel"},Qe=U({props:{messageList:null},emits:["send"],setup(e,{emit:t}){const n=$("peerInfo"),o=I(""),s=()=>{o.value!==""&&(t("send",{type:"text",content:o.value}),o.value="")};return(a,c)=>(d(),f("div",Oe,[v("div",Ae,[(d(!0),f(M,null,R(e.messageList,(r,i)=>(d(),f("div",{key:i,class:O(["message",{self:r.user.id===l(n).id}])},[v("div",Fe,[E(N,{name:r.user.name,"bg-color":r.user.bgColor},null,8,["name","bg-color"])]),v("div",ze,[r.dataType==="text"?(d(),f(M,{key:0},[Y(T(r.content),1)],64)):r.dataType==="image"?(d(),f("img",{key:1,src:r.dataUrl},null,8,je)):r.dataType==="file"?(d(),f("a",{key:2,href:r.dataUrl,download:r.fileName},T(r.fileName),9,Ye)):q("",!0)]),v("div",Ge,T(l(H).unix(r.sendTime).format("YYYY-MM-DD HH:MM:ss")),1)],2))),128))]),v("div",Je,[ne(v("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>o.value=r),type:"text"},null,512),[[ge,o.value]]),v("button",{onClick:c[1]||(c[1]=r=>s())},[E(l(He))])])]))}});var Ke=V(Qe,[["__scopeId","data-v-747caa06"]]);const We=()=>{confirm("This will clear all user infomation, Are your suer ?")&&(localStorage.clear(),location.reload())},Xe={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Ze=v("path",{d:"M191.015 710.892V222.523c-51.2 0-92.553 41.354-92.553 90.585v578.954c0 51.2 41.353 92.553 92.553 92.553h458.831c51.2 0 92.554-41.353 92.554-90.584H374.154c-100.43 0-183.139 0-183.139-183.139zm703.016-397.784h-153.6c-51.2 0-92.554-41.354-92.554-90.585v-153.6c1.97-15.754-11.815-29.538-29.539-29.538H374.154c-51.2 0-92.554 41.353-92.554 90.584v578.954c0 51.2 41.354 90.585 92.554 90.585h458.83c51.2 0 92.554-41.354 92.554-90.585V344.615c0-17.723-13.784-31.507-31.507-31.507zm25.6-128L777.846 45.292c-3.938-3.938-7.877-5.907-13.784-5.907-11.816 0-21.662 9.846-21.662 21.661v100.43c0 33.478 27.57 61.047 61.046 61.047h100.43c11.816 0 21.662-9.846 21.662-21.661 0-5.908-1.969-9.847-5.907-15.754z"},null,-1),et=[Ze];function tt(e,t){return d(),f("svg",Xe,et)}var nt={render:tt};const st={class:"message-text"},ot=U({props:{text:{type:String,default:""},visible:{type:Boolean,default:!1},delay:{type:Number,default:2e3},type:{type:String,default:"success"},onFullDestroyed:{type:Function,default:()=>({})}},emits:["fullDestroyed"],setup(e,{emit:t}){const n=e,o=I(n.visible);se(()=>{o.value=n.visible});const s=()=>{o.value=!0,setTimeout(()=>{o.value=!1,setTimeout(()=>{t("fullDestroyed")},200)},n.delay)};return he(()=>{setTimeout(()=>{s()},1)}),(a,c)=>(d(),f("div",{class:O(["message",`${o.value?"showed":""} ${e.type}`])},[v("div",st,T(e.text),1)],2))}});var at=V(ot,[["__scopeId","data-v-75766499"]]);function it(e,t){const o=E(at,x({visible:!1,text:e,onFullDestroyed:()=>{K(null,s),s.parentNode===document.body&&document.body.removeChild(s)}},t)),s=document.createElement("div");o.props&&(o.props.onVnodeUnmounted=()=>{document.body.removeChild(s)}),K(o,s),document.body.appendChild(s)}var ie=(e=>(e.request="Srequest",e.accept="Saccept",e.decline="Sdecline",e.stop="Sstop",e))(ie||{});function ct(){let e;const t=u=>{e=u,c()};let n=!1;const o=new EventTarget;let s=()=>Promise.reject(),a;const c=()=>{e.on("data",u=>{if(!!Object.values(ie).includes(u.type))switch(u.type){case"Saccept":o.dispatchEvent(new CustomEvent("accept"));break;case"Srequest":{s(u.content).then(()=>{e.send({type:"Saccept"})}).catch(()=>{e.send({type:"Sdecline"})});break}case"Sdecline":o.dispatchEvent(new CustomEvent("decline"));break;case"Sstop":a(),o.dispatchEvent(new CustomEvent("decline"));break}})};return{use:t,requestAccept:async u=>await new Promise((S,_)=>{e.send({type:"Srequest",content:u}),n=!1,o.addEventListener("accept",()=>{n&&_(),S(!0)}),o.addEventListener("decline",()=>{_()})}),onBeRequested:u=>{s=u},onBeStopped:u=>{a=u},stop:()=>{o.dispatchEvent(new CustomEvent("stop")),e.send({type:"Sstop"})}}}var ce=(e=>(e.hand="handflag",e))(ce||{});function rt(){const e=$("userInfo",{name:G(),bgColor:z()}),t=Boolean(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia),n=$("peerInfo",{id:"",createTime:-1}),o=be({participants:[k(x({},e.value),{id:n.value.id,userMedia:t})],type:"",status:b.initial,userMedia:t});let s;const a=r=>{s=r,c(),o.participants[0].id=n.value.id},c=()=>{o.status=b.connected,s.on("data",r=>{!Object.values(ce).includes(r.type)||(o.status=b.connected,o.participants.every(i=>i.id!==r.user.id)&&(o.participants.push(r.user),s.send({type:"handflag",user:k(x({},e.value),{id:n.value.id,useMedia:t})})))}),s.send({type:"handflag",user:k(x({},e.value),{id:n.value.id,userMedia:t})})};return{use:a,connectionInfo:o}}var re=(e=>(e.start="Mstart",e.content="MContent",e.end="Mend",e))(re||{});function lt(){const e=$("userInfo",{name:G(),bgColor:z()}),t=$("peerInfo",{id:"",createTime:-1});let n;const o=i=>{n=i,c()},s=new Map,a=I([]),c=()=>{n.on("data",i=>{var m;if(!!Object.values(re).includes(i.type))switch(i.type){case"Mstart":s.set(i.id,i),a.value.push(i);break;case"MContent":const p=k(x(x({},s.get(i.id)),i),{type:"Mend",recieveTime:H().unix(),dataUrl:i.dataType!=="text"?URL.createObjectURL(new Blob([i.content],{type:i.fileType})):void 0});s.set(i.id,p);const u=a.value.findIndex(S=>S.id===i.id);a.value[u]=p,n.send({id:i.id,type:"Mend",reciveTime:(m=s.get(i.id))==null?void 0:m.recieveTime});break;case"Mend":s.set(i.id,k(x({},s.get(i.id)),{recieveTime:i.recieveTime}));const w=a.value.findIndex(S=>S.id===i.id);a.value[w].recieveTime=i.recieveTime;break}})};return{use:o,messageList:a,sendData:i=>{const m=we(),p={user:{name:e.value.name,id:t.value.id,bgColor:e.value.bgColor},sendTime:H().unix(),dataType:i.dataType,type:"Mstart",id:m,fileType:i.fileType,fileName:i.fileName},u={content:i.content,id:m,type:"MContent",fileType:i.fileType,fileName:i.fileName};n.send(p),n.send(u);const w=k(x(x({},p),u),{recieveTime:-1,dataUrl:i.dataType!=="text"?URL.createObjectURL(new Blob([i.content],{type:i.fileType})):void 0});s.set(m,w),a.value.push(w)}}}function dt(e){const t=$("peerInfo",{id:"",createTime:-1}),n=$("connectStatus",b.initial),o=1/0;if(t.value.id===""||H().unix()-t.value.createTime>o&&n.value===b.spare){t.value={id:"",createTime:-1};const a=new W;a.on("open",()=>{t.value={id:a.id,createTime:H().unix()},e(a)})}const s=new W(t.value.id);s.on("open",()=>{e(s)})}function ut(){let e,t,n;const o=p=>{e=p,c()};let s=p=>{},a=new EventTarget;const c=()=>{e.on("call",p=>{p.answer(),p.on("stream",u=>{s(u),a.addEventListener("close",()=>{var w;(w=u==null?void 0:u.stop)==null||w.call(u)})}),p.on("close",function(){})})},r=(p,u)=>new Promise((w,S)=>{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({audio:!0,video:p==="video"},_=>{n=_,w(_),t=e.call(u,_,{metadata:{type:p,selfId:e.id}})},S)});return a.addEventListener("close",()=>{var p;!n||((p=n.stop)==null||p.call(n),n.getTracks().forEach(u=>{u.readyState==="live"&&u.stop()}))}),{use:o,call:r,close:()=>{t==null||t.close(),a.dispatchEvent(new CustomEvent("close"))},onStream:p=>{s=p}}}function pt(){let e;const t=()=>dt(p=>{e=p,c.connectionInfo.status=b.spare,p.on("connection",u=>{s(u)}),p.on("error",m)});t();let n;const o=p=>{if(!e||!p)return;if(c.connectionInfo.status===b.connecting){c.connectionInfo.status=b.stoping,e.on("disconnected",()=>{t(),c.connectionInfo.status=b.spare}),e.disconnect();return}c.connectionInfo.status=b.connecting,e.on("error",m);const u=e.connect(p);s(u)},s=p=>{n=p,i.use(e),n.on("open",()=>{c.use(n),a.use(n),r.use(n)}),n.on("error",m)},a=lt(),c=rt(),r=ct(),i=ut(),m=p=>{c.connectionInfo.status=b.spare,it(p,{type:"error"})};return{toConnect:o,messageSystem:a,connectInfoSystem:c,acceptSystem:r,streamSystem:i}}const vt={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},ft=v("path",{d:"M1024 201.143v621.714q0 24-22.286 33.714-7.428 2.858-14.285 2.858-15.429 0-25.715-10.858L731.43 618.286v94.857q0 68-48.286 116.286t-116.286 48.285H164.571q-68 0-116.285-48.285T0 713.143V310.857q0-68 48.286-116.286t116.285-48.285h402.286q68 0 116.286 48.285t48.286 116.286v94.286l230.285-229.714Q972 164.57 987.43 164.57q6.857 0 14.285 2.858Q1024 177.143 1024 201.143z"},null,-1),mt=[ft];function yt(e,t){return d(),f("svg",vt,mt)}var _t={render:yt};const gt={class:"picker"},ht={key:0,class:"popup"},bt=["onClick"],wt=U({props:{list:null},emits:["choose"],setup(e,{emit:t}){const n=I(!1);return(o,s)=>{const a=xe("click-outside");return d(),f("div",gt,[v("div",{class:"content",onClick:s[0]||(s[0]=()=>n.value=!n.value)},[oe(o.$slots,"default",{},void 0,!0)]),E(ae,{name:"slide-fade"},{default:F(()=>[n.value?ne((d(),f("div",ht,[(d(!0),f(M,null,R(e.list,(c,r)=>(d(),f("div",{class:"item",key:r,onClick:()=>{t("choose",c,r),n.value=!1}},T(c),9,bt))),128))])),[[a,()=>n.value=!1]]):q("",!0)]),_:1})])}}});var xt=V(wt,[["__scopeId","data-v-71516db5"]]);const Ct={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},It=v("path",{d:"M914.286 708.571q0 15.429-5.715 40.286t-12 39.143q-12 28.571-69.714 60.571-53.714 29.143-106.286 29.143-15.428 0-30-2t-32.857-7.143-27.143-8.285-31.714-11.715-28-10.285q-56-20-100-47.429-73.143-45.143-151.143-123.143T196.571 516.571q-27.428-44-47.428-100-1.714-5.142-10.286-28t-11.714-31.714-8.286-27.143-7.143-32.857-2-30q0-52.571 29.143-106.286 32-57.714 60.572-69.714 14.285-6.286 39.142-12t40.286-5.714q8 0 12 1.714 10.286 3.429 30.286 43.429 6.286 10.857 17.143 30.857t20 36.286T376 216q1.714 2.286 10 14.286t12.286 20.285 4 16.286q0 11.429-16.286 28.572t-35.429 31.428-35.428 30.286-16.286 26.286q0 5.142 2.857 12.857T306.571 408t8 13.714 6.572 10.857q43.428 78.286 99.428 134.286t134.286 99.429q1.143.571 10.857 6.571t13.715 8 11.714 4.857T604 688.571q10.286 0 26.286-16.285t30.285-35.429T692 601.43t28.571-16.286q8 0 16.286 4t20.286 12.286 14.286 10Q785.714 620 802 629.143t36.286 20 30.857 17.143q40 20 43.428 30.285 1.715 4 1.715 12z"},null,-1),St=[It];function kt(e,t){return d(),f("svg",Ct,St)}var X={render:kt};function Tt(){const e=["touchstart","scroll"],t=o=>{document.body.style.position="fixed",o.preventDefault(),o.stopPropagation()};e.forEach(o=>{document.body.addEventListener(o,s=>{document.body.style.position="fixed",s.preventDefault(),s.stopPropagation()})});const n=()=>e.forEach(o=>{document.body.removeEventListener(o,t)});return Ce(()=>{n()}),n}function Et(){const e=I([]),t=n=>{e.value.push(n)};return Ie(()=>{e.value=[]}),{setRefs:t,refs:e}}const $t={class:"video-chat"},Mt={class:"videos"},Lt={key:0,class:"avatars"},Bt={key:1,class:"info"},qt={class:"buttons"},Ut=U({props:{status:null,users:null,type:null},emits:["decline","accept","stop"],setup(e,{expose:t,emit:n}){const o=e,{refs:s,setRefs:a}=Et();return se(()=>{o.users.forEach((c,r)=>{var i;c.stream&&((i=s.value)==null?void 0:i[r])&&(s.value[r].srcObject=c.stream,s.value[r].play())})}),Tt(),t({videoRefs:s}),(c,r)=>(d(),f("div",$t,[v("div",{class:O(["frame",{waiting:o.status===l(C).waiting,connecting:o.status===l(C).connecting,holding:o.status===l(C).holding}])},[v("div",Mt,[(d(!0),f(M,null,R(e.users,(i,m)=>(d(),f("video",{key:m,ref_for:!0,ref:l(a),playsinline:""}))),128))]),o.status!==l(C).connecting?(d(),f("div",Lt,[(d(!0),f(M,null,R(o.users,(i,m)=>(d(),D(N,{name:i.name,"bg-color":i.bgColor,editable:!1,key:m},null,8,["name","bg-color"]))),128))])):q("",!0),o.status!==l(C).connecting?(d(),f("div",Bt,T(o.status===l(C).waiting?"Waiting for accept...":"You get a VideoCall Invitation"),1)):q("",!0),v("div",qt,[o.status===l(C).holding?(d(),f("button",{key:0,class:"accept",onClick:r[0]||(r[0]=i=>n("accept"))},[E(l(X))])):q("",!0),v("button",{class:"decline",onClick:r[1]||(r[1]=i=>n(o.status===l(C).holding?"decline":"stop"))},[E(l(X))])])],2)]))}});var Vt=V(Ut,[["__scopeId","data-v-92af8a1c"]]);const Dt={class:"video tool-button"},Pt=U({props:{acceptSystem:null,users:null,streamSystem:null},setup(e){const t=e,n=I(t.users),o=$("peerInfo",{id:"",createTime:-1}),s=I(!1),a=I(C.waiting),c=I("video"),r=()=>{n.value.forEach(_=>{_.stream=void 0})},i=new EventTarget,m=async _=>{const L=n.value.findIndex(y=>y.id!==o.value.id),g=await t.streamSystem.call(_,n.value[L].id);n.value[0].stream=g},p=()=>{i.dispatchEvent(new CustomEvent("accept")),a.value=C.connecting,m(c.value)},u=()=>{i.dispatchEvent(new CustomEvent("decline")),s.value=!1,t.streamSystem.close(),r()},w=()=>{i.dispatchEvent(new CustomEvent("stop")),s.value=!1,t.acceptSystem.stop(),t.streamSystem.close(),r()},S=async _=>{c.value=_,s.value=!0,a.value=C.waiting;try{await t.acceptSystem.requestAccept(_),a.value=C.connecting,await m(_)}catch{s.value=!1}};return t.acceptSystem.onBeStopped(()=>{s.value=!1,i.dispatchEvent(new CustomEvent("stop")),t.streamSystem.close(),r()}),t.acceptSystem.onBeRequested(_=>new Promise((L,g)=>{c.value=_,s.value=!0,a.value=C.holding;const y=()=>{a.value=C.connecting,L(!0)},h=()=>{s.value=!1,g()},P=()=>{s.value=!1,g(),i.removeEventListener("accept",y),i.removeEventListener("decline",h),i.removeEventListener("stop",P)};i.addEventListener("accept",y),i.addEventListener("decline",h),i.addEventListener("stop",P)})),t.streamSystem.onStream(_=>{const L=n.value.findIndex(g=>g.id!==o.value.id);L!==-1&&(n.value[L].stream=_)}),(_,L)=>(d(),f(M,null,[E(xt,{list:["video","voice"],onChoose:S},{default:F(()=>[v("button",Dt,[E(l(_t))])]),_:1}),(d(),D(Se,{to:"body"},[E(ae,null,{default:F(()=>[s.value?(d(),D(Vt,{key:0,type:c.value,status:a.value,users:n.value,onAccept:p,onDecline:u,onStop:w},null,8,["type","status","users"])):q("",!0)]),_:1})]))],64))}});var Rt=V(Pt,[["__scopeId","data-v-ca364aa0"]]);const Nt={tabindex:"1",class:"input-field"},Ht=["value"],Ot=U({props:{modelValue:null,showFilterList:{type:Boolean},filterList:null},emits:["update:modelValue"],setup(e){const t=I(),n=I();return(o,s)=>(d(),f("div",{tabindex:"0",class:"custom-input",ref_key:"wrapRef",ref:n},[v("div",Nt,[v("input",ke({ref_key:"inputRef",ref:t,value:e.modelValue,onInput:s[0]||(s[0]=a=>{var c;return o.$emit("update:modelValue",(c=a==null?void 0:a.target)==null?void 0:c.value)})},o.$attrs),null,16,Ht),v("button",{class:"clear",onTouchstart:s[1]||(s[1]=()=>{}),onClick:s[2]||(s[2]=()=>{var a;o.$emit("update:modelValue",""),(a=t.value)==null||a.focus()})},null,32)]),e.showFilterList?(d(),f("div",{key:0,class:"filter-list",onClick:s[4]||(s[4]=()=>{var a;(a=n.value)==null||a.blur()})},[(d(!0),f(M,null,R(e.filterList,(a,c)=>(d(),f("div",{key:c,class:"list-item",onClick:s[3]||(s[3]=()=>{})},[oe(o.$slots,"default",Te(Ee(a)),()=>[Y(T(a),1)],!0)]))),128))])):q("",!0)],512))}});var At=V(Ot,[["__scopeId","data-v-093840cf"]]);function Ft(e=15){const t=$("history",{users:[]}),n=t.value.users;return{users:n,addUser:a=>{const c=n.findIndex(r=>r.id===a.id);if(c===-1){if(n.length===e)return;console.log("pushed",a),n.unshift(a),t.value=k(x({},t.value),{users:n})}else n[c]=a,t.value=k(x({},t.value),{users:n})},deleteUser:a=>{const c=n.findIndex(r=>r.id===a);n.splice(c,1),t.value=k(x({},t.value),{users:n})}}}const zt={class:"header"},jt={class:"avatars"},Yt={class:"tools"},Gt={class:"content"},Jt={key:1,class:"home"},Qt={class:"welcome"},Kt={class:"id-field"},Wt=Y(" Your ID is "),Xt={class:"id-text allow-select"},Zt={class:"id-editor"},en=["onClick"],tn={class:"right"},nn={class:"full-name"},sn=["onClick"],on=["disabled"],an=U({setup(e){const t=$("peerInfo",{id:"",createTime:-1}),n=pt(),o=A(()=>n.connectInfoSystem.connectionInfo.status),s=g=>{n.toConnect(g)},a=n.messageSystem.messageList,c=g=>{n.messageSystem.sendData(k(x({},g),{dataType:"text"}))},r=async()=>{const g=await Ue(),y=g.item(0),h=(y==null?void 0:y.type.includes("image"))?"image":"file";n.messageSystem.sendData({dataType:h,content:new Blob(g,{type:y==null?void 0:y.type}),fileType:y.type,fileName:y.name})},i=$("userInfo",{name:G(),bgColor:z()}),m=n.connectInfoSystem.connectionInfo,p=A(()=>n.connectInfoSystem.connectionInfo.participants.every(g=>g.userMedia)),u=I(""),{users:w,deleteUser:S,addUser:_}=Ft(),L=A(()=>w.length>0);return te(m.participants,()=>{m.participants.forEach(g=>{g.id!==t.value.id&&_(g)})}),(g,y)=>(d(),f(M,null,[v("div",zt,[v("div",jt,[l(o)!==l(b).connected?(d(),D(N,{key:0,name:l(i).name,"bg-color":l(i).bgColor,editable:!0,onChange:y[0]||(y[0]=h=>{i.value=k(x({},l(i)),{name:h})})},null,8,["name","bg-color"])):(d(!0),f(M,{key:1},R(l(m).participants,(h,P)=>(d(),D(N,{name:h.name,"bg-color":h.bgColor,editable:!1,key:P},null,8,["name","bg-color"]))),128))]),v("div",Yt,[l(o)!==l(b).connected?(d(),f("button",{key:0,class:"reset",onClick:y[1]||(y[1]=h=>l(We)())}," reset ")):(d(),f(M,{key:1},[v("button",{class:"file tool-button",onClick:y[2]||(y[2]=()=>r())},[E(l(nt))]),l(p)?(d(),D(Rt,{key:0,"accept-system":l(n).acceptSystem,users:l(m).participants,"stream-system":l(n).streamSystem},null,8,["accept-system","users","stream-system"])):q("",!0)],64))])]),v("div",Gt,[l(o)===l(b).connected?(d(),D(Ke,{key:0,"message-list":l(a),onSend:c},null,8,["message-list"])):(d(),f("div",Jt,[v("div",Qt,"Hello,"+T(l(i).name),1),v("div",Kt,[Wt,v("span",Xt,T(l(t).id),1)]),v("div",Zt,[E(At,{modelValue:u.value,"onUpdate:modelValue":y[3]||(y[3]=h=>u.value=h),placeholder:"input id here",type:"text",class:"id-input","show-filter-list":l(L),"filter-list":l(w)},{default:F(h=>[v("div",{class:"history-user",onClick:()=>{u.value=h.id}},[v("div",tn,[E(N,{name:h.name,"bg-color":h.bgColor},null,8,["name","bg-color"]),v("div",nn,T(h.name),1)]),v("button",{class:"remove-user",onClick:P=>{l(S)(h.id),P.stopPropagation()}},null,8,sn)],8,en)]),_:1},8,["modelValue","show-filter-list","filter-list"])]),v("button",{class:O(["connect-button",{loading:l(o)===l(b).connecting}]),disabled:l(t).id===null||l(o)===l(b).stoping||l(o)===l(b).initial,onClick:y[4]||(y[4]=h=>s(l(Ve)(u.value))),onTouchstart:y[5]||(y[5]=()=>{})},T(l(o)),43,on)]))])],64))}});var cn=V(an,[["__scopeId","data-v-6bd01bc0"]]);const rn=e=>e instanceof Element,B=new Map;let Z;document.addEventListener("mousedown",e=>Z=e),document.addEventListener("mouseup",e=>{for(const t of B.values())for(const{documentHandler:n}of t)n(e,Z)});function ee(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:rn(t.arg)&&n.push(t.arg),function(o,s){const a=t.instance.popperRef,c=o.target,r=s==null?void 0:s.target,i=!t||!t.instance,m=!c||!r,p=e.contains(c)||e.contains(r),u=e===c,w=n.length&&n.some(_=>_==null?void 0:_.contains(c))||n.length&&n.includes(r),S=a&&(a.contains(c)||a.contains(r));i||m||p||u||w||S||t.value(o,s)}}const ln={beforeMount(e,t){B.has(e)||B.set(e,[]),B.get(e).push({documentHandler:ee(e,t),bindingFn:t.value})},updated(e,t){B.has(e)||B.set(e,[]);const n=B.get(e),o=n.findIndex(a=>a.bindingFn===t.oldValue),s={documentHandler:ee(e,t),bindingFn:t.value};o>=0?n.splice(o,1,s):n.push(s)},unmounted(e){B.delete(e)}},le=()=>{document.body.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",le);window.addEventListener("DOMContentLoaded",le);const de=$e(cn);de.directive("clickOutside",ln);de.mount("#app");
