!function(){function e(e){var a,o,r,n=2;for("undefined"!=typeof Symbol&&(o=Symbol.asyncIterator,r=Symbol.iterator);n--;){if(o&&null!=(a=e[o]))return a.call(e);if(r&&null!=(a=e[r]))return new t(a.call(e));o="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function t(e){function a(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return a(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):a(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):a(t.apply(this.s,arguments))}},new t(e)}System.register(["./usePeek-legacy-8660f37a.js","./index-legacy-c669afa8.js"],(function(t,a){"use strict";var o,r,n,l,i,s,c,v,p,u,d,m,f,y,b,h,g,w,x,k,C,I,$,_,S,j,Y,P,T,E,G,R,V,A,B,U,D,L,O,z,F,H,q,M,J,K=document.createElement("style");return K.textContent=".popover[data-v-ba871690]{position:relative}.popover-overlay[data-v-ba871690]{position:absolute;z-index:1;transition:all ease-in-out .2s var(--539ec4f1)}.popover-overlay.top-left[data-v-ba871690]{bottom:calc(100% + var(--373e2f03));left:0}.popover-overlay.top[data-v-ba871690]{bottom:calc(100% + var(--373e2f03));left:50%;transform:translate(-50%)}.popover-overlay.top-right[data-v-ba871690]{bottom:calc(100% + var(--373e2f03));right:0}.popover-overlay.bottom-left[data-v-ba871690]{top:calc(100% + var(--373e2f03));left:0}.popover-overlay.bottom[data-v-ba871690]{top:calc(100% + var(--373e2f03));left:50%;transform:translate(-50%)}.popover-overlay.bottom-right[data-v-ba871690]{top:calc(100% + var(--373e2f03));right:0}.popover.trigger-hover .popover-overlay[data-v-ba871690]{pointer-events:none;transform:translateY(-10px);opacity:0}.popover.trigger-hover .popover-overlay.bottom[data-v-ba871690],.popover.trigger-hover .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(-10px)}.popover.trigger-hover:hover .popover-overlay[data-v-ba871690]{pointer-events:auto;transition-delay:var(--a16bb7d4);transform:translateY(0);opacity:1}.popover.trigger-hover:hover .popover-overlay.bottom[data-v-ba871690],.popover.trigger-hover:hover .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(0)}.popover.trigger-focus .popover-overlay[data-v-ba871690]{pointer-events:none;transform:translateY(-10px);opacity:0}.popover.trigger-focus .popover-overlay.bottom[data-v-ba871690],.popover.trigger-focus .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(-10px)}.popover.trigger-focus:focus .popover-overlay[data-v-ba871690]{pointer-events:auto;transition-delay:var(--a16bb7d4);transform:translateY(0);opacity:1}.popover.trigger-focus:focus .popover-overlay.bottom[data-v-ba871690],.popover.trigger-focus:focus .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(0)}.popover.trigger-focus-within .popover-overlay[data-v-ba871690]{pointer-events:none;transform:translateY(-10px);opacity:0}.popover.trigger-focus-within .popover-overlay.bottom[data-v-ba871690],.popover.trigger-focus-within .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(-10px)}.popover.trigger-focus-within:focus .popover-overlay[data-v-ba871690],.popover.trigger-focus-within:focus-within .popover-overlay[data-v-ba871690]{pointer-events:auto;transition-delay:var(--a16bb7d4);transform:translateY(0);opacity:1}.popover.trigger-focus-within:focus .popover-overlay.bottom[data-v-ba871690],.popover.trigger-focus-within:focus .popover-overlay.top[data-v-ba871690],.popover.trigger-focus-within:focus-within .popover-overlay.bottom[data-v-ba871690],.popover.trigger-focus-within:focus-within .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(0)}.popover.trigger-manual .manual-hidden.popover-overlay[data-v-ba871690]{pointer-events:none;transform:translateY(-10px);opacity:0}.popover.trigger-manual .manual-hidden.popover-overlay.bottom[data-v-ba871690],.popover.trigger-manual .manual-hidden.popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(-10px)}.popover.trigger-manual .popover-overlay[data-v-ba871690]{pointer-events:auto;transition-delay:var(--a16bb7d4);transform:translateY(0);opacity:1}.popover.trigger-manual .popover-overlay.bottom[data-v-ba871690],.popover.trigger-manual .popover-overlay.top[data-v-ba871690]{transform:translate(-50%) translateY(0)}.primary-input[data-v-8e27a71c]{border-width:2px;--un-border-opacity:1;border-color:rgba(120,113,108,var(--un-border-opacity));border-radius:.375rem;padding:.5rem 1rem;outline:2px solid transparent;outline-offset:2px}.primary-input[data-v-8e27a71c]:focus{--un-border-opacity:1;border-color:rgba(28,25,23,var(--un-border-opacity))}\n",document.head.appendChild(K),{setters:[e=>{o=e._,r=e.a,n=e.b,l=e.r,i=e.P,s=e.c,c=e.u,v=e.s,p=e.d,u=e.i,d=e.e},e=>{m=e.r,f=e.g,y=e.o,b=e.d,h=e.c,g=e.a,w=e.b,x=e.n,k=e.e,C=e.u,I=e.t,$=e.f,_=e.h,S=e.i,j=e.w,Y=e.j,P=e.k,T=e.l,E=e.m,G=e.F,R=e.p,V=e.q,A=e.s,B=e._,U=e.v,D=e.x,L=e.y,O=e.z,z=e.A,F=e.B,H=e.C,q=e.D,M=e.E,J=e.G}],execute:function(){const K=(t,a)=>{const o=m(""),{splitter:r,charGapTime:n,lineGapTime:l,replayGapTime:i}={splitter:e=>e.split(""),charGapTime:500,lineGapTime:1e3,replayGapTime:2e3,...a},{sleep:s,stop:c}=(()=>{let e;return{sleep:t=>new Promise(((a,o)=>{e=o,setTimeout((()=>{a()}),t)})),stop:()=>{var t;null===(t=e)||void 0===t||t()}}})(),v=()=>{(async()=>{var a,c=!1,p=!1;try{for(var u,d=e(t);c=!(u=await d.next()).done;c=!1){const t=u.value;{let a="";var m,f=!1,y=!1;try{for(var b,h=e(r(t).map(((e,t)=>({char:e,index:t}))));f=!(b=await h.next()).done;f=!1){const{char:e,index:t}=b.value;o.value=`${a}${e}`,await s(n),a=o.value}}catch(g){y=!0,m=g}finally{try{f&&null!=h.return&&await h.return()}finally{if(y)throw m}}await s(l)}}}catch(g){p=!0,a=g}finally{try{c&&null!=d.return&&await d.return()}finally{if(p)throw a}}await s(i),v()})().catch((()=>{}))},p=()=>{c(),o.value=""};return f()&&y((()=>{p()})),{actText:o,stop:p,start:v}},N=b({__name:"Popover",props:{visible:{type:Boolean,default:!1},trigger:{default:"hover"},placement:{default:"bottom"},showDelay:{default:"0.2s"},hideDelay:{default:"0s"},offset:{default:"0px"},overlayClass:null},setup:e=>(C((t=>({"539ec4f1":e.hideDelay,"373e2f03":e.offset,a16bb7d4:e.showDelay}))),(t,a)=>(k(),h("div",{class:x(["popover",`trigger-${e.trigger}`]),tabindex:"0"},[g(t.$slots,"default",{},void 0,!0),w("div",{class:x(["popover-overlay",[e.placement,e.overlayClass,{"manual-hidden":"manual"===e.trigger&&!e.visible}]])},[g(t.$slots,"overlay",{},void 0,!0)],2)],2)))}),Q=o(N,[["__scopeId","data-v-ba871690"]]),W=["value","placeholder"],X={class:"w-full min-h-10 bg-white shadow-xl rounded max-h-30 overflow-y-auto"},Z={class:"text-center py-1 text-stone-600 text-sm"},ee=["onClick"],te=["onClick"],ae=[(e=>(V("data-v-8e27a71c"),e=e(),A(),e))((()=>w("div",{class:"i-mdi:close"},null,-1)))],oe=o(b({__name:"MainInput",props:{modelValue:null,history:null},emits:["update:modelValue","remove","select"],setup(e){const t=I("instruction-content").split("++"),{actText:a,start:o,stop:n}=K(t,{splitter:e=>e.split("--")});$((()=>{o()}));const l=m();return(t,o)=>{var i;return k(),_(Q,{ref_key:"popoverEl",ref:l,trigger:"focus-within",class:"w-full z-1","overlay-class":"w-[calc(100%+8px)]"},S({default:j((()=>[w("input",{value:e.modelValue,onInput:o[0]||(o[0]=e=>{var a;return t.$emit("update:modelValue",null===(a=e.target)||void 0===a?void 0:a.value)}),class:"primary-input my-1 w-full",type:"text",placeholder:R(a),onFocus:o[1]||(o[1]=(...e)=>R(n)&&R(n)(...e))},null,40,W)])),_:2},[null!==(i=e.history)&&void 0!==i&&i.length?{name:"overlay",fn:j((()=>[w("div",X,[w("div",Z,Y(t.$t("history-connections")),1),(k(!0),h(G,null,P(e.history,((e,a)=>(k(),h("div",{class:"w-full flex items-center justify-between px-2 py-2 cursor-pointer hover:bg-stone-100 active:bg-stone-200",onClick:a=>{var o;t.$emit("select",e.peerId),null===(o=l.value)||void 0===o||o.$el.blur()}},[T(r,{name:e.name,class:"w-10 h-10 text-sm"},null,8,["name"]),w("button",{class:"icon-button",onClick:E((a=>t.$emit("remove",e.peerId)),["stop"])},ae,8,te)],8,ee)))),256))])])),key:"0"}:void 0]),1536)}}}),[["__scopeId","data-v-8e27a71c"]]),re=e=>navigator.clipboard?navigator.clipboard.writeText(e):(e=>{const t=document.createElement("input");return t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select(),new Promise(((e,a)=>{try{document.execCommand("copy"),e()}catch(o){a()}document.body.removeChild(t)}))})(e),ne=["disabled"],le=["disabled"],ie={class:"bg-gray-800 w-full p-4 rounded-t flex flex-col items-center justify-center"},se={class:"text-white text-center text-sm py-2 break-all"},ce={class:"flex flex-col place-center px-4 py-2"},ve={class:"font-bold py-1"},pe=[w("div",{class:"i-mdi:share-variant w-5 h-5"},null,-1)],ue=[w("div",{class:"i-mdi:content-copy w-5 h-5"},null,-1)],de=[w("div",{class:"i-mdi:email w-5 h-5"},null,-1)],me={class:"text-xs text-center text-stone-600 py-1"},fe=b({__name:"ShareButton",props:{peerId:null},emits:["shared"],setup(e,{emit:t}){const o=e,r=m(!1),i=U((()=>!Boolean(o.peerId))),s=m();var c,v;c=s,v=async()=>{await O(),!0===r.value&&(r.value=!1)},$((()=>{if(!c.value)return;const e=c.value,t=t=>{var a;e!==t.target&&null!==(a=t.target)&&void 0!==a&&a.contains(e)&&v()};window.addEventListener("click",t),y((()=>{window.removeEventListener("click",t)}))}));const p=m(),u=()=>{r.value=!0,n("Share","Open_Share_Panel"),p.value||(p.value=l(4),t("shared",p.value))},d=I("link-to-your-friends-peek"),f=U((()=>((e,t=window.origin)=>{const a=new URLSearchParams;return Object.entries(e).forEach((([e,t])=>{a.append(e,t)})),`${t}?${a.toString()}`})({targetId:o.peerId,ack:p.value}))),b=async()=>{await re(f.value),z({content:"Copy link success"})},g=()=>{window.open(`mailto:?subject=${encodeURIComponent(d)}&body=${f.value}`)},x=Boolean(navigator.share),C=()=>{navigator.share({title:d,text:d,url:f.value})},S=m(),P=m(!0);return D((()=>[r.value,f.value]),(()=>{if(r.value&&f.value){if(!S.value)return;(async(e,t,o={})=>{(await B((()=>a.import("./browser-legacy-d6874cc7.js").then((e=>e.b))),void 0)).toCanvas(t,e,o,(e=>{throw e}))})(f.value,S.value),P.value=!0}})),(e,t)=>(k(),_(Q,{visible:r.value,trigger:"manual",placement:"top",offset:"-100px"},{overlay:j((()=>[w("div",{ref_key:"sharePanel",ref:s,class:"w-70 bg-white rounded-lg shadow-md flex flex-col place-center rounded cursor-pointer"},[w("div",ie,[w("canvas",{ref_key:"codeEl",ref:S,class:"w-[180px] h-[180px]"},null,512),w("div",se,Y(R(f)),1)]),w("div",ce,[w("div",ve,Y(e.$t("share-link-to-friends")),1),w("div",null,[R(x)?(k(),h("button",{key:0,class:"icon-button mx-1",onClick:C},pe)):L("",!0),w("button",{class:"icon-button mx-1",onClick:b},ue),w("button",{class:"icon-button mx-1",onClick:g},de)]),w("div",me,Y(e.$t("share-link-generated")),1)])],512)])),default:j((()=>[w("button",{disabled:R(i),class:"icon-button w-12 flex place-center",title:"share",onClick:u},[w("button",{class:"i-mdi:ios-share w-6 h-6 disabled:bg-gray",disabled:R(i)},null,8,le)],8,ne)])),_:1},8,["visible"]))}}),ye=b({__name:"GuideButton",setup(e){const t=()=>{n("Guide","Show"),F({selections:[I("ok")],content:I("peek-instruction")})};return(e,a)=>(k(),h("div",{class:"text-sm text-stone-600 underline cursor-pointer",onClick:t},Y(e.$t("whats-this")),1))}}),[be,he]=H("connect_user_history",(()=>[])),ge=()=>({info:m(((e=location.href)=>{const t=new URLSearchParams(new URL(e).search);return Object.fromEntries(t.entries())})()),clear:()=>{history.replaceState({},"0",window.origin)}}),we={class:"w-full h-full flex justify-center"},xe={class:"p-4 w-full max-w-[400px] flex flex-col items-center"},ke=w("div",{class:"header-placeholder flex-1 max-h-[10%]"},null,-1),Ce={class:"w-full flex-shrink-0 mt-1 flex flex-col items-center justify-center"},Ie={class:"py-1 truncate max-w-[90%]"},$e={class:"font-bold"},_e={class:"text-light-700 text-sm"},Se={class:"text-light-50 text-center font-bold px-1"},je={class:"text-light-700 text-sm"},Ye={key:1,class:"text-stone-500 text-sm text-white"},Pe=["disabled"],Te={class:"pt-4"},Ee={class:"pt-4"},Ge=[w("div",{class:"i-mdi:head-remove-outline w-5 h-5 bg-stone-500"},null,-1)];t("default",b({__name:"Home",setup(e){var t;const{add:a,remove:o,history:l}=(()=>{const e=m(be()),t=t=>{e.value=e.value.filter((e=>e.peerId!==t)),he(e.value)};return{add:a=>{t(a.peerId),e.value.push(a),he(e.value)},remove:t,history:q(e)}})(),f=U((()=>[...l.value.map((e=>({...e})))].reverse())),y=m(),{openStatus:b,connectStatus:g,info:C,peek:$}=c();v((async(e,t,o)=>{const r=async()=>{await e(),S.replace("/chat"),a({name:o.name,peerId:o.peerId})};if(o.acceptAck&&y.value&&o.acceptAck===y.value)await r();else try{await F({selections:[{label:I("decline"),value:!1},{label:I("accept"),value:!0,entering:async()=>{await r()}}],content:`${o.name} ${I("wants-to-connect-confirm")}`})||t()}catch(n){}}));const{userInfo:_}=d(),S=J(),j=async e=>{var t;if(!e)return;const{connect:o}=$.connectTo(e,{..._,media:p,acceptAck:null===(t=G.value)||void 0===t?void 0:t.ack});n("Communication","Start");try{const e=await o;S.replace("/chat"),a({name:e.name,peerId:P.value}),n("Communication","Success")}catch(r){if(u(r))return void z({type:"error",content:I("connect-rejected")});z({type:"error",content:I("connect-failed")})}},P=m(""),E=e=>{P.value=e},{info:G,clear:V}=ge(),A=(B=b,L=s.Available,O=i.Spare,new Promise(((e,t)=>{const a=D(B,((o,r)=>{if((void 0===H||H===r)&&o===L)return e(),void a();o===O&&(t(),a())}))})));var B,L,O,H;null!==(t=G.value)&&void 0!==t&&t.targetId&&(P.value=G.value.targetId,A.then((()=>{j(P.value)})),V());const K=U((()=>b.value!==s.Available||g.value!==i.Spare||0===P.value.length)),N=async()=>{var e;null!==(e=C.value)&&void 0!==e&&e.peerId&&(await re(C.value.peerId),z({content:I("copy-id-success")}))};return(e,t)=>{var a,l,c;return k(),h("div",we,[w("div",xe,[ke,w("div",Ce,[T(r,{name:R(_).name,"onUpdate:name":t[0]||(t[0]=e=>R(_).name=e),editable:"",class:"h-20 text-xl"},null,8,["name"]),w("span",Ie,[M("Hello, "),w("span",$e,Y(R(_).name),1)])]),w("div",{class:x(["rounded-md flex flex-col place-center py-2 my-1 w-full min-h-20 cursor-pointer transition-all",[null!==(a=R(C))&&void 0!==a&&a.peerId?"bg-green-700":"bg-yellow-500"]])},[null!==(l=R(C))&&void 0!==l&&l.peerId?(k(),h("div",{key:0,class:"flex flex-col place-center",onClick:N},[w("div",_e,Y(e.$t("Your id:")),1),w("div",Se,Y(R(C).peerId),1),w("div",je,Y(e.$t("click to copy")),1)])):(k(),h("div",Ye,Y(e.$t("loading"))+"...",1))],2),T(oe,{modelValue:P.value,"onUpdate:modelValue":t[1]||(t[1]=e=>P.value=e),history:R(f),onRemove:R(o),onSelect:E},null,8,["modelValue","history","onRemove"]),w("button",{class:"primary-button my-1 w-full",disabled:R(K),onClick:t[2]||(t[2]=e=>(async()=>{j(P.value)})())},Y(R(g)===R(i).Connecting?`${e.$t("connecting")}...`:R(b)===R(s).Initial?`${e.$t("waiting")}...`:e.$t("connect")),9,Pe),w("div",Te,[T(fe,{"peer-id":null===(c=R(C))||void 0===c?void 0:c.peerId,onShared:t[3]||(t[3]=e=>y.value=e)},null,8,["peer-id"])]),w("div",Ee,[T(ye)])]),w("button",{class:"absolute bottom-2 right-2 icon-button",title:"reset",onClick:t[4]||(t[4]=e=>(async()=>{try{await F({selections:[{label:I("yes"),value:!0},{label:I("no"),value:!1}],content:I("rest-confirm-message"),modalClose:!0,showClose:!0})&&(n("Reset"),localStorage.clear(),location.reload())}catch(e){}})())},Ge)])}}}))}}}))}();
